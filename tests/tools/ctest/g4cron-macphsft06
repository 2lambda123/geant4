#!/usr/bin/env bash
#------------------------------------------------------------------

#---Xerces-C-------------------------------------------------------
export XERCESC_ROOT_DIR=/build/externals/xerces-c-3.1.0
export DYLD_LIBRARY_PATH=${XERCESC_ROOT_DIR}/lib:${DYLD_LIBRARY_PATH}

#------------------------------------------------------------------
THIS=$(dirname $0)
WORKDIR=/build/cdash/G4
CONFIG=mac106-gcc42
if [ "$1" ]; then
  MODE=$1
else
  MODE=nightly
fi

#---Update All Scripts------------------------------------------------
svn update ${THIS}

export VERSION=g4tags-dev
export SOURCE=${WORKDIR}/${MODE}/${VERSION}
export BINARY=${WORKDIR}/${MODE}/${CONFIG}

if [ ! -d "${SOURCE}" ]; then 
  ${THIS}/g4tagsvn.py update -c ${VERSION} -d ${SOURCE} -q
fi
#---Run the CTest script-------------------------------------------
ctest -V -S ${THIS}/g4${MODE}.cmake 

