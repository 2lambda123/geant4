#!/usr/bin/env bash 

#------------------------------------------------------------------
export LC_CTYPE=en_US.UTF-8
export LC_ALL=en_US.UTF-8

if [ $# -ne 2 ] ; then
   echo "Error, wrong number of arguments"
   echo " arguments lcgplatform, e.g x86_64-slc5 and compiler version, e.g 4.3"
   exit 1
else
   lcgbase=$1
   gccver=$2
fi

echo $0

CtestDir=$(dirname $0)

# use common setup for environment

. ${CtestDir}/g4ec-slc-setup ${lcgbase} ${gccver}

if [ "${RESET_SOURCE}" = "yes" ]; then
  rm -rf ${SOURCE}
fi

if [ ! -d "${SOURCE}" ]; then
  ${CtestDir}/g4tagsvn.py update -c ${VERSION} -d ${SOURCE} -q
fi

#---Run the CTest script-------------------------------------------
echo "Starting CTest script for configuration ${CONFIG} at `date`" 
ctest -V -S ${CtestDir}/g4${MODE}.cmake 
