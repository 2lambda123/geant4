?RCS:
?MAKE: g4vis_build_openglqt_driver g4vis_use_openglqt: g4system g4vis_build_dawn_driver Qt g4ui_build_qt_session Myread Getfile Loc cat test
?MAKE:	-pick add $@ %<
?S:g4vis_build_openglqt_driver:
?S:	This variable determines whether the Qt OpenGL driver will be built 
?S:.
?S:g4vis_use_openglqt:
?S:	This variable determines whether the Qt OpenGL driver will be used.
?S:.
?INIT:#INITIALIZE QT VIS DRIVER OPTIONS
?INIT:g4vis_build_openglqt_driver='n'
?INIT:g4vis_use_openglqt='n'
?INIT:#END QT VIS DRIVER OPTIONS

#
# BEGIN QTVIS/QT PROBE
#
# Because the vis driver only works with UI, only probe if g4ui_none is
# NOT set AND g4vis_none is NOT set.
# Also, Qt vis driver has dependency on Qt UI module - so only ask if
# build is required IF Qt UI was selected.
#
if test "x$g4ui_none" = "xn" -a "x$g4vis_none" = "xn" ; then
if test "x$g4ui_build_qt_session" = "xy" ; then
    # Query the user to see if build of Qt GL module is needed
	g4message="Enable building of the Qt OpenGL visualization driver?"

    # Read in the user response
    dflt=$g4vis_build_openglqt_driver
    rp=$g4message
    . ./myread
    gans=$ans

    # Check response and take set variables as needed.
    case $gans in
        n*|N*)
	    g4vis_build_openglqt_driver=n
            g4vis_use_openglqt=n
	    ;;
	y*|Y*)
	    g4vis_build_openglqt_driver=y
            g4vis_use_openglqt=y
            ;;
    esac

    ##########

    ##########
    # Now, if user chose to build module, we need to check for a Qt
    # installation
    #
    if test "x$g4vis_build_openglqt_driver" = "xy" ; then
	# NB Have to supply arg to qt script, just blank in this case!
	qt_search_dir=""
	. ./qt

	# If we didn't find Qt automatically, then ask user if they know
	# where it's installed...
	if test "x$g4_havegoodqt" = "xno" || test "x$g4_is_qt4" = "xno" ; then
	    promptend="no"
	    user_qthome="the standard locations"

            while test "x$promptend" = "xno" ; do
	        g4message=`cat << EOM

Autodetection failed to locate Qt4 in $qthomeloc on your system.
Please enter the path to your Qt4 install (i.e. if Qt4 is installed
in PATH/include/QT, PATH/include or PATH/include/qt4, enter PATH),
or type '-' to CANCEL the build of the Qt UI module.
Qt path:
EOM`
		dflt=""
                fn='d~(-)'
		rp=$g4message
		. ./getfile
		user_qthome=$ans

		if test "x$user_qthome" = "x-" ; then
		    # Cancel build...
		    g4vis_build_openglqt_driver=n
		    g4vis_use_openglqt=n
		    echo "configure: build/use of Qt OpenGl driver cancelled"
		    promptend=yes
		else
		    # Check for installation in user directory
		    echo " "
		    qt_search_dir=$user_qthome
		    . ./qt

		    if test "x$g4_havegoodqt" = "xyes" && test "x$g4_is_qt4" = "xyes" ; then
			promptend=yes
		    fi
		fi #END TEST user_qthome = -
            done #END while promptend=no (for user input of Qt install)
        fi #END TEST g4_havegoodqt = no (for user prompt)
    fi #END TEST g4vis_build_openglqt_driver (whether to build at all)
else # TEST g4ui_build_qt_session
    # Because we can 'drop through' this test on repeat
    # running Configure, force build and use to n
    g4vis_build_openglqt_driver=n
    g4vis_use_openglqt=n
fi #END TEST g4ui_build_qt_session (dependency on Qt UI module)
fi #END TEST g4ui_none = n AND g4vis_none=n
