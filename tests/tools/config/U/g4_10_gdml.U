?RCS:
?MAKE:g4lib_build_gdml g4gdml_xercesc_root: g4vis_oglhome g4vis_build_openglqt_driver Myread Getfile cat rm test
?MAKE:	-pick add $@ %<
?S:g4lib_build_gdml:
?S:	This variable determines whether to build the optional GDML module.
?INIT:#INITIALIZE GDML OPTIONS
?INIT:g4lib_build_gdml='n'


# Now query the user to see if they want to build the GDML plugin
echo " "
echo "*OPTIONS FOR GEANT4 OPTIONAL EXTENSION MODULES*"

g4message="Enable the Geometry Description Markup Language (GDML) module?"
dflt=$g4lib_build_gdml
rp=$g4message
. ./myread
gans=$ans

#
# Check response
#
case $gans in
     n*|N*)
	g4lib_build_gdml=n
	;;
     y*|Y*)
	g4lib_build_gdml=y
	;;
esac


#
# If user does want to build GDML plugin, now try to locate Xerces install
#
if test "X$g4lib_build_gdml" != "Xn"; then

   if test "X$g4gdml_xercesc_root" = "X"; then
      #probe for Xerces, using example from UI and Vis
      xercesc_root=`find $g4gdml_xercesc_root /usr/include /usr/local/include \
/opt/local/include /sw/include -type d -name xercesc 2>/dev/null | xargs echo`

      #If we got something, strip off the include/xerces part
      if test "X$xercesc_root" != "X"; then
	 g4gdml_xercesc_root=`dirname $xercesc_root`
	 g4gdml_xercesc_root=`dirname $g4gdml_xercesc_root`

	 echo "checking for XercesC install... $g4gdml_xercesc_root"
     echo " "
      else
         g4gdml_xercesc_root=""
	 echo "checking for XercesC install... no"
      fi
   fi #END OF XERCES AUTOPROBE

   #
   # If the autoprobe failed, prompt the user to enter the path to the Xerces
   # install
   #
   if test "X$g4gdml_xercesc_root" = "X"; then

      promptend="no"
      xercesloc="the standard locations"
      
      while test "$promptend" = "no"; do
	    g4message=`cat << EOM

Autodetection failed to locate XercesC in $xercesloc on your system. 
Please enter the path to your XercesC install (i.e. if XercesC is installed
in PATH/include/xercesc, enter PATH), or type '-' to CANCEL the build of the 
GDML module.
XercesC path:
EOM`

	    dflt=$g4gdml_xercesc_root
	    fn='d~(-)'
	    rp=$g4message
	    . ./getfile

	    #check for user cancellation
	    if test "X$ans" = "X-"; then
	       g4lib_build_gdml=n
	       g4gdml_xercesc_root=""
	       echo "G4LIB_BUILD_GDML cancelled..."
		   echo " "
	       promptend=yes
	    else
	       if test -r "$ans/include/xercesc"; then
		  g4gdml_xercesc_root=$ans
		  echo "checking for XercesC install... $g4gdml_xercesc_root"
		  echo " "
		  promptend=yes
	       else
	          xercesloc=$ans
	          echo "checking for Xercesc install... no"
	       fi
            fi #END OF USER INPUT CHECKING
      done #END OF WHILE LOOP OVER USER INPUT
   fi #END OF USER INPUT SECTION

   #
   # If a filter on g4gdml_xerces_root is needed to remove common system paths
   # then it should be put here...
   #
	if test "x$g4gdml_xercesc_root" = "x/usr" -o "x$g4gdml_xercesc_root" = "x/usr/local" ; then
		g4gdml_xercesc_root=""
	fi

fi #END XERCES PROBE

#END OF GDML/XERCES PROBE
