
                        Examples for event biasing
                        --------------------------

This exmple includes applications to demonstrate the usage of
different biasing techniques supported in Geant4, or possible from the 
user applications.


General remark to biasing
-------------------------
The tools provided for importance sampling (or geometrical splitting and
Russian roulette) require the user to have a good understanding of the 
physics in the problem. This is because the user has to decide which 
particle types have to be biased, define the regions (physical volumes, 
replicas) and assign importances to that regions. If this is not done 
properly it can not be expected that the results describe a real 
experiment. The examples given here only demonstrate how to use the tools
technically. They don't intend to produce physical correct results.

General remark to scoring
-------------------------
A interface G4VPScorer is provided for the user. The user may create his 
own class to perform the desired scoring. The user defined class 
therefore should inherit from the interface G4VPScorer. 
An example of an implementation of a scorer is G4StandardScorer
which may be found in source/run. 
The scoring in these examples is done with a G4StandardScorer.
When scoring is done in a "scoring" or in a "importance" geometry
special action has to be taken to prevent counting of
"collisions" with boundaries of the tracking geometry as interactions.
This is differently handled when scoring is done in the tracking geometry.

Known problems
--------------
In the following scenario it can happen that a particle is not
biased and it's weight is therefore not changed even if it crosses
a boundary where biasing should happen.
The importance sampling creates particles on boundaries 
between volumes. If the GPIL method of a physical process returns 
0 as step length for a particle on a boundary and if the PostStepDoIt of
that process changes the direction of the particle to go back in the 
former volume the biasing won't be invoked. 
This will produce particles with weights that do not correspondent to the
importance of the current volumes.

Further information:
--------------------
Short description of biasing and scoring:
http://dressel.home.cern.ch/dressel/Biasing.html

Descrtiption of the standard scoring:
http://dressel.home.cern.ch/dressel/StandardScoring.html

Instructions for the usage of a messenger for simple problems:
http://dressel.home.cern.ch/dressel/Mess.html

The executable
==============
The executable allows to run several different simulations
discribed below. Each simulation derives from the class 
B01VSimulation. B01VSimulation declares the method 
Construct() a.o. The class B01SimulationFactory holds an object
of each simulation. When a particular simulation is chosen
the Construct() method of that object is called.
Possible simulations are:
                              MassImportance
                              MassImportanceScoring
                              MassScoring
                              NGapplication
                              ParallelImportance
                              ParallelImportanceScoring
                              ParallelScoring
The executable can be run by typing
exampleB01 <simulation> <numberofenvents>.


The geometry
============
In this example a 180 cm thick concrete cylinder with the 
radius 100 cm is bombarded with neutrons. 
In the examples using only the tracking geometry the concrete
cylinder is subdivided into 18 slobs of 10 cm thickness.
In the examples using a parallel geometry the single concrete
cylinder is used as tracking or mass geometry. In addition a parallel 
geometry is used which consists of 18 cylinders with radius 110 cm
(so overlapping the tracking world volume) covering the concrete
block of the mass geometry.



I. Examples for scoring without biasing
=======================================

I. 1. MassScoring
-----------------
This example shows how to  use scoring in the "tracking" geometry.
It scores several values for neutrons for every physical volume
in the tracking geometry.
It uses the scorer G4Scorer. This scorer creates a cell-scorer
for evry cell that is hit by a particle of a chosen type
(neutron in this example).  
Standard scores are printed after the run.


I. 2. ParallelScoring
---------------------
This example shows how to use scoring in a "parallel" or "scoring" 
geometry. In this example a tracking and a scoring geometry is 
constructed. Neutrons are scored in the scoring geometry using
a G4Scorer object.  
Standard scores are printed after the run.


II. Examples for biasing without scoring
========================================

II. 1. MassImportance
----------------------
This example shows how to use importance sampling in the "tracking" 
geometry. An object of type G4IStore is used to assign 
importance values to cells.
It does not do scoring. 


II. 2. ParallelImportance
-------------------------
This example shows how to use importance sampling according to a 
"parallel" or "importance" geometry. 
An object of type G4IStore is used to assign importance values to cells.
It does not do scoring. 


III. Examples for biasing and scoring
=====================================

III. 1. MassImportanceScoring
-----------------------------
Importance sampling and scoring in the "tracking" geometry.
In addition this is an example of how to chose which cells to score.
In this example a G4CellScorerStore is used to specify
the cells to be scored. For scoring the G4CellStoreScorer
is used.
Standard scores are printed after the run.


III. 2. ParallelImportanceScoring
-------------------
Importance sampling and scoring in a "parallel" geometry.
Like (III. 1.) but for the parallel geometry.



IV. Example for weight window sampling
-------------------------------------

III. 3. NGapplication
---------------------
Biasing neutrons and scoring gammas in a "parallel" geometry.
Importance sampling and weight window biasing 
together with scoring in a parallel geometry is applied for neutrons.
Since this example intents to show the weight window sampling 
the primary neutrons are created with the relatively high
energy of 300 MeV (init.mac). Neutrons with this energy
penetrate the concrete (according to the chosen physics list)
relatively easy. So no importance sampling would be necessary.
The high energy is selected to show the effect of the weight window 
sampling. High energetic secondaries which are not importance sampled 
may create neutrons which have a weight different from the inverse of 
the importance in the cell. If a finite weight window is chosen this 
results in relative average weights of the tracks in a given cell not 
equal to one.
If the upper and lower limit of the weight window is set to 1 
the relative weights are 1.

